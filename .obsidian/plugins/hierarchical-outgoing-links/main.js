/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var E=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var S=Object.getOwnPropertyNames;var b=Object.prototype.hasOwnProperty;var D=(r,t)=>{for(var e in t)E(r,e,{get:t[e],enumerable:!0})},V=(r,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of S(t))!b.call(r,s)&&s!==e&&E(r,s,{get:()=>t[s],enumerable:!(i=L(t,s))||i.enumerable});return r};var F=r=>V(E({},"__esModule",{value:!0}),r);var N={};D(N,{default:()=>x});module.exports=F(N);var y=require("obsidian");var C=require("obsidian");var g=require("obsidian"),d=class r{constructor(t,e,i){this.canToggleIcon=!0;this.app=t,this.isCollapsed=!1,this.parent=e,this.treeNode=i,this.treeNodeViewChildren=[]}render(){this.treeItem=this.parent.createDiv({cls:"tree-item"}),this.treeItemSelf=this.treeItem.createDiv({cls:"tree-item-self is-clickable backlink-item"}),this.appendEndNode(this.treeItemSelf,this.treeNode);let t="";this.treeNode.children.length==0&&(t=this.treeNode.count.toString()),this.treeItemSelf.createDiv({cls:"tree-item-flair-outer"}).createEl("span",{cls:"tree-item-flair",text:t}),this.treeNode.children.length>0&&this.appendTreeItemChildren(this.treeItem,this.treeNode.children)}appendEndNode(t,e){this.treeItemIcon=t.createDiv({cls:"tree-item-icon collapse-icon"});let i=e.name;if(e.children&&e.children.length==0){let n=this.app.metadataCache.getFirstLinkpathDest(e.name,"");n?(i=n.basename,this.treeItemIcon.appendChild((0,g.getIcon)("lucide-link"))):(this.treeItemIcon.appendChild((0,g.getIcon)("lucide-file-plus")),this.canToggleIcon=!1)}else this.treeItemIcon.appendChild((0,g.getIcon)("right-triangle"));t.createDiv({cls:"tree-item-inner",text:i}).addEventListener("click",n=>{this.navigateTo(e.name)}),this.treeItemIcon.addEventListener("click",n=>{this.toggle()})}appendTreeItemChildren(t,e){let i=t.createDiv({cls:"tree-item-children"});e.forEach(s=>{let n=new r(this.app,i,s);n.render(),this.treeNodeViewChildren.push(n)})}navigateTo(t){let e=this.app.metadataCache.getFirstLinkpathDest(t,"");e&&this.app.workspace.openLinkText(e.name,e.path)}toggleOn(){if(this.treeItemSelf.toggleClass("is-collapsed",!1),this.treeItemIcon.toggleClass("is-collapsed",!1),this.treeItemSelf.nextSibling){let t=this.treeItemSelf.nextSibling;t.style.display="block"}this.treeNodeViewChildren.forEach(t=>{t.toggleOn()})}toggleOff(){if(this.treeItemSelf.toggleClass("is-collapsed",!0),this.canToggleIcon&&this.treeItemIcon.toggleClass("is-collapsed",!0),this.treeItemSelf.nextSibling){let t=this.treeItemSelf.nextSibling;t.style.display="none"}this.treeNodeViewChildren.forEach(t=>{t.toggleOff()})}toggle(){this.isCollapsed?(this.isCollapsed=!1,this.toggleOff()):(this.isCollapsed=!0,this.toggleOn())}};var a=class{constructor(t,e){this.links=t,this.settings=e}getFilteredLinks(){if(this.settings.excludeFilesFilter)try{let t=new RegExp(this.settings.excludeFilesFilter),e={};for(let i in this.links)t.test(i)||(e[i]=this.links[i]);return e}catch(t){return this.links}else return this.links}getHierarchy(){let t=[],e={result:t};for(let i in this.getFilteredLinks())i.split("/").reduce((s,n,l,p)=>(s[n]||(s[n]={result:[]},s.result.push({name:n,count:this.links[i],children:s[n].result})),s[n]),e);return t}};var I=require("obsidian"),u=class{constructor(t,e){this.app=t,this.parent=e}render(){let t=this.parent.createDiv({cls:"clickable-icon nav-action-button"});t.appendChild((0,I.getIcon)("filter")),t.addClass("is-active"),t.onClickEvent(e=>{this.app.setting.open(),this.app.setting.openTabById("hierarchical-outgoing-links")})}};var T=require("events"),m=class extends T.EventEmitter{constructor(e,i){super();this.svgCollapse='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>';this.app=e,this.parent=i}render(){this.button=this.parent.createDiv({cls:"clickable-icon nav-action-button"}),this.button.innerHTML=this.svgCollapse,this.button.addEventListener("click",e=>{this.button.classList.toggle("is-active"),this.emit("collapse-click",e)})}isCollapsed(){return this.button.hasClass("is-active")}};var v=class{constructor(t,e,i){this.app=t,this.parent=i,this.settings=e}render(){let t=this.parent.createDiv({cls:"nav-header"}).createDiv({cls:"nav-buttons-container"});this.collapseButton=new m(this.app,t),this.collapseButton.render(),this.settings.excludeFilesFilter&&(this.filterButton=new u(this.app,t),this.filterButton.render())}};var o="hierarchical-outgoing-links",f=class extends C.ItemView{constructor(e,i){super(e);this.treeNodeViews=[];this.plugin=i}getViewType(){return o}getIcon(){return"links-going-out"}getDisplayText(){return"Hierarchical outgoing links"}async initialize(){let e=this.containerEl.children[1];e.empty();let i=this.app.workspace.getActiveFile();if(i){let s=this.app.metadataCache.resolvedLinks[i.path],n=this.app.metadataCache.unresolvedLinks[i.path];this.createPane(e,s,n)}}createPane(e,i,s){let n=new v(this.app,this.plugin.settings,e);n.render(),n.collapseButton.on("collapse-click",H=>{n.collapseButton.isCollapsed()?this.treeNodeViews.forEach(w=>{w.toggleOff()}):this.treeNodeViews.forEach(w=>{w.toggleOn()})});let l=e.createDiv({cls:"outgoing-link-pane"}),p=new a(i,this.plugin.settings),h=new a(s,this.plugin.settings);this.append_links(l,"Links",p.getHierarchy()),this.append_links(l,"Unresolved links",h.getHierarchy())}append_links(e,i,s){let n=e.createDiv({cls:"tree-item-self is-clickable"});n.createEl("div",{text:i}),e.appendChild(n);let l=e.createDiv({cls:"search-result-container"});s.forEach(p=>{let h=new d(this.app,l,p);h.render(),this.treeNodeViews.push(h)})}register_events(){this.plugin.registerEvent(this.app.metadataCache.on("changed",()=>{this.initialize()})),this.plugin.registerEvent(this.app.workspace.on("layout-change",()=>{this.initialize()})),this.plugin.registerEvent(this.app.workspace.on("file-open",()=>{this.initialize()}))}async onOpen(){return this.register_events(),this.initialize()}};var c=require("obsidian"),k=class extends c.PluginSettingTab{constructor(t,e){super(t,e),this.plugin=e}display(){let{containerEl:t}=this;t.empty();let e;new c.Setting(t).setName("Exclude files filter").setDesc("Exclude files that match regular expression").addText(i=>{i.setPlaceholder("").setValue(this.plugin.settings.excludeFilesFilter).onChange(async s=>{this.plugin.settings.excludeFilesFilter=s,await this.plugin.saveSettings()}),e=i}),new c.Setting(t).setName("Examples").setDesc("Common examples to demonstrate using the exclude filter").addButton(i=>{i.setButtonText("Exclude Images").onClick(async s=>{await this.setExcludeFilterValue(e,"\\.png")})}).addButton(i=>{i.setButtonText("Exclude PDFs").onClick(async s=>{await this.setExcludeFilterValue(e,"\\.pdf")})})}async setExcludeFilterValue(t,e){t.setValue(e),this.plugin.settings.excludeFilesFilter=e,await this.plugin.saveSettings()}};var x=class extends y.Plugin{constructor(){super(...arguments);this.DEFAULT_SETTINGS={excludeFilesFilter:null}}async onload(){await this.loadSettings(),this.addSettingTab(new k(this.app,this)),this.registerView(o,e=>(this.view=new f(e,this),this.view)),this.addCommand({id:"show-hierarchical-outgoing-links",name:"Show hierarchical outgoing links",callback:()=>{this.activateView()}}),this.activateView()}onunload(){}async loadSettings(){this.settings=Object.assign({},this.DEFAULT_SETTINGS,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.view.initialize()}async activateView(){let{workspace:e}=this.app,i=null,s=e.getLeavesOfType(o);s.length>0?i=s[0]:(i=e.getRightLeaf(!1),await(i==null?void 0:i.setViewState({type:o,active:!0}))),e.revealLeaf(i)}};

/* nosourcemap */